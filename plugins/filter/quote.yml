# Copyright (c) 2022 Ansible Project
# GNU General Public License v3.0+ (see COPYING or https://www.gnu.org/licenses/gpl-3.0.txt)

DOCUMENTATION:
  name: quote
  author:
  - Jordan Borean (@jborean93)
  short_description: Quotes argument(s) for various Windows shells
  seealso:
  - module: ansible.windows.win_command
  - module: ansible.windows.win_shell
  description:
  - Quotes argument(s) for the various Windows command line shells.
  - Defaults to escaping arguments based on the Win32 C argv parsing rules that M(ansible.windows.win_command) uses.
  - Using I(shell='cmd') or I(shell='powershell') can be set to escape arguments for those respective shells.
  - Each value is escaped in a way to ensure the process gets the literal argument passed in and meta chars escaped.
  positional: _input
  options:
    _input:
      description:
      - The string, list, or dict of values to quote.
      - A string or list of strings will be quoted.
      - When using a dict as the input, the final form will be in C(KEY="value") to match the MSI parameter format.
      type: raw
      required: true
    shell:
      description:
      - The shell to quote the arguments for.
      - By default no shell is used and the arguments are quoted with the Win32 C quoting rules.
      type: string
      choices:
      - None
      - cmd
      - powershell
      default: None

EXAMPLES: |
  - name: Escape an argument for win_command
    ansible.windows.win_command:
      cmd: my.exe {{ argument1 | ansible.windows.quote }}

  - name: Escape an argument for PowerShell
    ansible.windows.win_shell: |
      $var = {{ argument1 | ansible.windows.quote(shell='powershell') }}
      Write-Host $var

RETURN:
  _value:
    description:
    - The quoted input value(s) as a single space delimited string.
    type: string